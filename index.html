<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Tetris Attempt</title>
<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
<link rel="stylesheet" type="text/css" href="css/main.css" />
</head>
<body>

    <div id="board"></div>

    <script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
    <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.2/js/tether.min.js"></script>
    <script src="https://cdn.rawgit.com/twbs/bootstrap/v4-dev/dist/js/bootstrap.js" crossorigin="anonymous"></script>
    <script src="https://use.fontawesome.com/343cc4bbfb.js"></script>

    



    <script>

    var min = 1
    var max = 25
    
    var Grid = function () {
        for (i = min; i < max; i++){
            $("#board").append("<div class='trow r" + i +"'></div>");            
            for (j = min; j < max; j++){
                $(".r" + i).append("<div class='tcell cell-" + i + "-" + j + "'></div>");
            }
        }        
    };

    $(document).ready(function(){            
        var grid = new Grid();
    });

    </script>











    <script type="text/javascript">
    function Line() {
        this['positions'] = {} ;
        this['current_position'] = 'pos_1';
        this['positions']['pos_1'] = [{x: 1, y: 10},{x: 1, y: 11},{x: 1, y: 12},{x: 1, y: 13}];
        this['positions']['pos_2'] = [{x: 0, y: 11},{x: 1, y: 11},{x: 2, y: 11},{x: 3, y: 11}];
        this['positions']['pos_3'] = [{x: 1, y: 10},{x: 1, y: 11},{x: 1, y: 12},{x: 1, y: 13}];
        this['positions']['pos_4'] = [{x: 0, y: 11},{x: 1, y: 11},{x: 2, y: 11},{x: 3, y: 11}];
    }

    var moveDown = function(shape){    
        ii = 0
        
        var interval = setInterval(function(){
            for (p in shape['positions']){
                $('.active').removeClass('active');
                for (blocks in shape['positions'][p]){
                    shape['positions'][p][blocks]['x'] += 1
                    var a = ".cell-" + shape['positions'][my_shape.current_position][blocks]['x'] + '-' + shape['positions'][my_shape.current_position][blocks]['y'];
                    $(a).addClass('active');
                    console.log(shape['positions'][p][blocks]);
                }
            }
            ii++
            if(ii >= 20) clearInterval(interval);
        },500);
    }

    var rotate = function(shape){
        $('.active').removeClass('active');
        switch(shape.current_position){
            case "pos_1":
                shape.current_position = "pos_2";
                break;
            case "pos_2":
                shape.current_position = "pos_3";
                break;
            case "pos_3":
                shape.current_position = "pos_4";
                break;
            case "pos_4":
                shape.current_position = "pos_1";
                break;
        }
        var a = ".cell-" + shape['positions'][my_shape.current_position][blocks]['x'] + '-' + shape['positions'][my_shape.current_position][blocks]['y'];
                    $(a).addClass('active');        
    }




    var my_shape = new Line();
    
    $( "body" ).keydown(function( event ) {
        if ( event.which == 38 ) {
            event.preventDefault();
            rotate(my_shape);
        }
    });

    moveDown(my_shape);
    rotate(my_shape);
    console.log(my_shape.current_position)
    rotate(my_shape);
    console.log(my_shape.current_position)

    </script>
</body>
</html>